\mbox{\hyperlink{classSalty}{Salty}} is a drop-\/in replacement for (some of) \href{https://github.com/typicaljoe/taffydb}{\texttt{ Taffy\+DB}}. It supports only the Taffy\+DB features that J\+S\+Doc has historically used.\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md812}{}\doxysection{Why Salty?}\label{md_node_modules__0djsdoc_salty_README_autotoc_md812}
Taffy\+DB lets you query an array of objects, similar to the way you would query a database. J\+S\+Doc 3.\+x used Taffy\+DB to manage {\itshape doclets}, or objects that contain information about your code.

Specifically, after J\+S\+Doc parsed your code, it passed the doclets to your J\+S\+Doc template as a Taffy\+DB object. The template then used Taffy\+DB queries to remove unneeded doclets, and to retrieve the doclets that were needed to generate documentation.

\mbox{\hyperlink{classSalty}{Salty}} exists because Taffy\+DB is no longer maintained and is the subject of a \href{https://www.cve.org/CVERecord?id=CVE-2019-10790}{\texttt{ C\+VE}}, causing Taffy\+DB to be flagged as a security risk. There\textquotesingle{}s no real security risk, but it sure looks like there is.

Also, Taffy\+DB \href{https://github.com/typicaljoe/taffydb/issues/166}{\texttt{ can\textquotesingle{}t decide what license it uses}}\+:


\begin{DoxyItemize}
\item The \href{https://github.com/typicaljoe/taffydb/blame/d4870cee370abffe510ba598b02e4e7ad6af5d2a/README.md\#L146-L156}{\texttt{ R\+E\+A\+D\+ME}} says that Taffy\+DB uses the \href{https://opensource.org/licenses/BSD-1-Clause}{\texttt{ 1-\/clause B\+SD License}}.
\item The \href{https://github.com/typicaljoe/taffydb/blob/d4870cee370abffe510ba598b02e4e7ad6af5d2a/package.json\#L32}{\texttt{ {\ttfamily package.\+json} file}} says that Taffy\+DB uses the \href{https://opensource.org/licenses/BSD-2-Clause}{\texttt{ 2-\/clause B\+SD License}}.
\item The \href{https://github.com/typicaljoe/taffydb/blob/d4870cee370abffe510ba598b02e4e7ad6af5d2a/License}{\texttt{ {\ttfamily License} file}} says that Taffy\+DB uses the \href{https://opensource.org/licenses/MIT}{\texttt{ M\+IT License}}.
\end{DoxyItemize}

By replacing Taffy\+DB with \mbox{\hyperlink{classSalty}{Salty}}, which uses the \href{https://github.com/jsdoc/jsdoc/blob/main/packages/jsdoc-salty/LICENSE}{\texttt{ Apache 2.\+0 License}}, J\+S\+Doc resolved the purported security issue and the licensing uncertainty.\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md813}{}\doxysection{Use Salty in a J\+S\+Doc template}\label{md_node_modules__0djsdoc_salty_README_autotoc_md813}
Starting in version 4.\+0.\+0, J\+S\+Doc no longer uses the {\ttfamily taffydb} package as a dependency. If you use a J\+S\+Doc template that comes with J\+S\+Doc 4.\+0.\+0 or later, then you don\textquotesingle{}t need to make any changes to the template.

Otherwise, your template might use the {\ttfamily taffydb} package. After you replace {\ttfamily taffydb} with {\ttfamily @jsdoc/salty}, your template should remain compatible with J\+S\+Doc 3.\+x.

To replace {\ttfamily taffydb} with {\ttfamily @jsdoc/salty}, do the following\+:


\begin{DoxyEnumerate}
\item In the template\textquotesingle{}s {\ttfamily publish.\+js} file, find the line or lines that require {\ttfamily taffydb}. They should look similar to one of the following\+:

\`{}\`{}{\ttfamily js // Old-\/school, without object destructuring (might use}var{\ttfamily or}let{\ttfamily instead of}const`) const taffy = require(\textquotesingle{}taffydb').taffy; // New-\/school, with object destructuring const \{ taffy \} = require(\textquotesingle{}taffydb\textquotesingle{}); \`{}\`{}\`{}
\item Replace {\ttfamily taffydb} with {\ttfamily @jsdoc/salty}\+:

\`{}\`{}\`{}js // Old-\/school, without object destructuring const taffy = require(\textquotesingle{}@jsdoc/salty\textquotesingle{}).taffy; // New-\/school, with object destructuring const \{ taffy \} = require(\textquotesingle{}@jsdoc/salty\textquotesingle{}); \`{}\`{}\`{}
\item If the template has a {\ttfamily package.\+json} file that includes {\ttfamily taffydb} as a dependency, then remove the {\ttfamily taffydb} dependency.
\item In the template\textquotesingle{}s {\ttfamily package.\+json} file, add {\ttfamily @jsdoc/salty} as a dependency.
\item Run {\ttfamily npm install} in the template directory, then confirm that the template works as expected.
\end{DoxyEnumerate}\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md814}{}\doxysection{Supported Taffy\+D\+B features}\label{md_node_modules__0djsdoc_salty_README_autotoc_md814}
\mbox{\hyperlink{classSalty}{Salty}} supports only the Taffy\+DB features that have historically been used by J\+S\+Doc templates. That means that most Taffy\+DB functionality is missing.

Specifically, \mbox{\hyperlink{classSalty}{Salty}} lets you do the following\+:\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md815}{}\doxysubsection{Create a database}\label{md_node_modules__0djsdoc_salty_README_autotoc_md815}

\begin{DoxyCode}{0}
\DoxyCodeLine{let db = taffy([\{ \mbox{\hyperlink{resolve_2test_2resolver_2nested__symlinks_2mylib_2async_8js_a82ca4ee5dd63e58a2bb967077dc8b8fb}{a}}: 3 \}, \{ \mbox{\hyperlink{resolve_2test_2resolver_2nested__symlinks_2mylib_2async_8js_a82ca4ee5dd63e58a2bb967077dc8b8fb}{a}}: 1, \mbox{\hyperlink{markdown-it_8min_8js_aa4026ad5544b958e54ce5e106fa1c805}{b}}: \textcolor{stringliteral}{'hello'} \}, \{ \mbox{\hyperlink{resolve_2test_2resolver_2nested__symlinks_2mylib_2async_8js_a82ca4ee5dd63e58a2bb967077dc8b8fb}{a}}: 7, \mbox{\hyperlink{markdown-it_8min_8js_aa4026ad5544b958e54ce5e106fa1c805}{b}}: 2 \}]);}
\end{DoxyCode}
\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md816}{}\doxysubsection{Sort items in a database}\label{md_node_modules__0djsdoc_salty_README_autotoc_md816}
Items are sorted in place. \mbox{\hyperlink{classSalty}{Salty}} uses the following sort order, which differs from, but is more predictable than, Taffy\+DB\+:


\begin{DoxyEnumerate}
\item Non-\/null, non-\/undefined values, in standard sort order
\item Null values
\item Explicitly undefined values\+: key is present, value is undefined
\item Implicitly undefined values\+: key is not present
\end{DoxyEnumerate}


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{// Sort by the `a` property}}
\DoxyCodeLine{db.sort(\textcolor{charliteral}{'a'});}
\DoxyCodeLine{\textcolor{comment}{// Sort by the `a` property, then the `b` property}}
\DoxyCodeLine{db.sort(\textcolor{stringliteral}{'a, b'});}
\end{DoxyCode}
\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md817}{}\doxysubsection{Get items from a database}\label{md_node_modules__0djsdoc_salty_README_autotoc_md817}
\`{}\`{}\`{}js // Get array of all items const empty\+Matcher = db().\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}; // Get array of items where {\ttfamily a} is either {\ttfamily 1} or {\ttfamily 3} const array\+Matcher = db(\{ a\+: \mbox{[}1, 3\mbox{]} \}).\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}; // Get array of items where {\ttfamily a} is {\ttfamily 1} and {\ttfamily b} is {\ttfamily hello} const multi\+Matcher = db(\{ a\+: 1 \}, \{ b\+: \textquotesingle{}hello\textquotesingle{} \}).\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}; // Get array of items where {\ttfamily b} is undefined const undefined\+Matcher = db(\{ b\+: \{ is\+Undefined\+: true \} \}).\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}; \`{}\`{}\`{}\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md818}{}\doxysubsection{Get items with a custom query function}\label{md_node_modules__0djsdoc_salty_README_autotoc_md818}
Within the query function, {\ttfamily this} is bound to the current item. As a result, the custom query function cannot be an arrow function.

\`{}\`{}\`{}js function query() \{ return this.\+a $>$ 1; \}

const items = db(query).\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}; // {\ttfamily items} is {\ttfamily \mbox{[}\{ a\+: 3 \}, \{ a\+: 7, b\+: 2 \}\mbox{]}} \`{}\`{}\`{}\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md819}{}\doxysubsection{Iterate over items in a database}\label{md_node_modules__0djsdoc_salty_README_autotoc_md819}
\`{}\`{}\`{}js // Iterate over all items db().each((item, i) =$>$ console.\+log(`\textquotesingle{}b' property at index \$\{i\}\+: \$\{item.\+b\}{\ttfamily )); // Iterate over items where}b{\ttfamily equals}hello` db(\{ b\+: \textquotesingle{}hello' \}).each((item) =$>$ console.\+log(`\textquotesingle{}a' property\+: \$\{item.\+a\}{\ttfamily )); }\`{}\`{}\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md820}{}\doxysubsection{Remove items from a database}\label{md_node_modules__0djsdoc_salty_README_autotoc_md820}
\`{}\`{}{\ttfamily js // Remove items where}a{\ttfamily equals}7{\ttfamily  db(\{ a\+: 7 \}).\mbox{\hyperlink{_0dcodemirror_2state_2dist_2index_8js_ac7e9ef6f325a9eb756e323c8cc6168e8}{remove()}}; // returns}1{\ttfamily (the number of items removed) // Remove items where}b{\ttfamily is undefined db(\{ b\+: \{ is\+Undefined\+: true \} \}).\mbox{\hyperlink{_0dcodemirror_2state_2dist_2index_8js_ac7e9ef6f325a9eb756e323c8cc6168e8}{remove()}}; // returns}1\`{} // Remove all items db().\mbox{\hyperlink{_0dcodemirror_2state_2dist_2index_8js_ac7e9ef6f325a9eb756e323c8cc6168e8}{remove()}}; \`{}\`{}\`{}\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md821}{}\doxysection{New features}\label{md_node_modules__0djsdoc_salty_README_autotoc_md821}
\mbox{\hyperlink{classSalty}{Salty}} probably won\textquotesingle{}t gain any new features, ever. It exists solely to meet the requirements of J\+S\+Doc.

The exception is if a J\+S\+Doc template uses Taffy\+DB features that aren\textquotesingle{}t available in \mbox{\hyperlink{classSalty}{Salty}}. If that\textquotesingle{}s the case, \href{https://github.com/jsdoc/jsdoc/issues}{\texttt{ create an issue}} with details about the template you\textquotesingle{}re using and the feature that\textquotesingle{}s missing.\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md822}{}\doxysection{Taffy\+D\+B, J\+S\+Doc, and security}\label{md_node_modules__0djsdoc_salty_README_autotoc_md822}
Is Taffy\+DB a security risk? And has J\+S\+Doc ever used Taffy\+DB in a way that creates a security risk? The answer to both questions is no.

First, \href{https://www.cve.org/CVERecord?id=CVE-2019-10790}{\texttt{ C\+V\+E-\/2019-\/10790}} says that \char`\"{}attackers can
use \mbox{[}the Taffy\+D\+B\mbox{]} vulnerability to access any data items in the D\+B.\char`\"{} But J\+S\+Doc used Taffy\+DB only to store data about your Java\+Script code. That data is no more sensitive than the code itself.

Also, J\+S\+Doc doesn\textquotesingle{}t persist the Taffy\+DB data to disk. It exists only while J\+S\+Doc is running.

Most important of all, Taffy\+DB doesn\textquotesingle{}t pretend to have any sort of access control. To the contrary, Taffy\+DB {\itshape intentionally} makes it very easy to access all of the data in a DB. If your DB is stored in a variable named {\ttfamily db}, then calling {\ttfamily db().\mbox{\hyperlink{__baseAt_8js_a2ec270f2dfe59f7a82f3a32bfdb40580}{get()}}} retrieves all of the data in the DB. \href{https://taffydb.com/working_with_data.html}{\texttt{ This method is documented}} as the \char`\"{}\mbox{[}p\mbox{]}refered \mbox{[}sic\mbox{]}
method for extracting data.\char`\"{} Because you can always access {\itshape all} of the data, it\textquotesingle{}s unclear why a bug that lets you access {\itshape some} of the data would create a security risk.

So \mbox{\hyperlink{classSalty}{Salty}} doesn\textquotesingle{}t mitigate a security risk or fix a security issue. However, in general, it\textquotesingle{}s not a good idea to tell people to ignore C\+V\+Es; also, it can be difficult to convince your colleagues or employer to ignore a specific C\+VE. For those reasons, it was worth the trouble to replace Taffy\+DB.\hypertarget{md_node_modules__0djsdoc_salty_README_autotoc_md823}{}\doxysection{What\textquotesingle{}s with the name?}\label{md_node_modules__0djsdoc_salty_README_autotoc_md823}
It\textquotesingle{}s a play on \char`\"{}saltwater taffy.\char`\"{} Hilarious! 