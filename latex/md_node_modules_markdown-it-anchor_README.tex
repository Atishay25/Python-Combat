
\begin{DoxyCode}{0}
\DoxyCodeLine{aria-\/label}
\end{DoxyCode}
 variant

\begin{quote}
A markdown-\/it plugin that adds an {\ttfamily id} attribute to headings and optionally permalinks. \end{quote}


English $\vert$ 中文 (v7.0.1)\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1357}{}\doxysection{Overview}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1357}
This plugin adds an {\ttfamily id} attribute to headings, e.\+g. {\ttfamily \#\# Foo} becomes {\ttfamily $<$h2 id=\char`\"{}foo\char`\"{}$>$Foo$<$/h2$>$}.

Optionally it can also include \href{\#permalinks}{\texttt{ permalinks}}, e.\+g. {\ttfamily $<$h2 id=\char`\"{}foo\char`\"{}$>$$<$a class=\char`\"{}header-\/anchor\char`\"{} href=\char`\"{}\#foo\char`\"{}$>$Foo$<$/a$>$$<$/h2$>$} and a bunch of other variants!


\begin{DoxyItemize}
\item \href{\#usage}{\texttt{ {\bfseries{Usage}}}}
\item \href{\#user-friendly-urls}{\texttt{ User-\/friendly U\+R\+Ls}}
\item \href{\#manually-setting-the-id-attribute}{\texttt{ Manually setting the {\ttfamily id} attribute}}
\item \href{\#compatible-table-of-contents-plugin}{\texttt{ Compatible table of contents plugin}}
\item \href{\#parsing-headings-from-html-blocks}{\texttt{ Parsing headings from H\+T\+ML blocks}}
\item \href{\#browser-example}{\texttt{ Browser example}}
\item \href{\#permalinks}{\texttt{ {\bfseries{Permalinks}}}}
\begin{DoxyItemize}
\item \href{\#header-link}{\texttt{ Header link}}
\item \href{\#link-after-header}{\texttt{ Link after header}}
\item \href{\#link-inside-header}{\texttt{ Link inside header}}
\item \href{\#aria-hidden}{\texttt{ A\+R\+IA hidden}}
\item \href{\#custom-permalink}{\texttt{ Custom permalink}}
\end{DoxyItemize}
\item \href{\#debugging}{\texttt{ Debugging}}
\item \href{\#development}{\texttt{ Development}}
\end{DoxyItemize}\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1358}{}\doxysection{Usage}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1358}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it'})()}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'}), \mbox{\hyperlink{catharsis_2bin_2parse_8js_ab0ff07ba233223b1d32000392ac9b0ea}{opts}})}
\end{DoxyCode}


See a \href{https://jsfiddle.net/9ukc8dy6/}{\texttt{ demo as J\+S\+Fiddle}}.

The {\ttfamily opts} object can contain\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endhead
{\ttfamily level} &Minimum level to apply anchors, or array of selected levels. &1  \\\cline{1-3}
{\ttfamily permalink} &A function to render permalinks, see \href{\#permalinks}{\texttt{ permalinks}} below. &{\ttfamily undefined}  \\\cline{1-3}
{\ttfamily slugify} &A custom slugification function. &See \href{https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js\#L3}{\texttt{ {\ttfamily index.\+js}}}  \\\cline{1-3}
{\ttfamily callback} &Called with token and info after rendering. &{\ttfamily undefined}  \\\cline{1-3}
{\ttfamily get\+Tokens\+Text} &A custom function to get the text contents of the title from its tokens. &See \href{https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js\#L5}{\texttt{ {\ttfamily index.\+js}}}  \\\cline{1-3}
{\ttfamily tab\+Index} &Value of the {\ttfamily tabindex} attribute on headings, set to {\ttfamily false} to disable. &{\ttfamily -\/1}  \\\cline{1-3}
{\ttfamily unique\+Slug\+Start\+Index} &Index to start with when making duplicate slugs unique. &1  \\\cline{1-3}
\end{longtabu}


All headers greater than the minimum {\ttfamily level} will have an {\ttfamily id} attribute with a slug of their content. For example, you can set {\ttfamily level} to 2 to add anchors to all headers but {\ttfamily h1}. You can also pass an array of header levels to apply the anchor, like {\ttfamily \mbox{[}2, 3\mbox{]}} to have an anchor on only level 2 and 3 headers.

If a {\ttfamily permalink} renderer is given, it will be called for each matching header to add a permalink. See \href{\#permalinks}{\texttt{ permalinks}} below.

If a {\ttfamily slugify} function is given, you can decide how to transform a heading text to a U\+RL slug. See \href{\#user-friendly-urls}{\texttt{ user-\/friendly U\+R\+Ls}}.

The {\ttfamily callback} option is a function that will be called at the end of rendering with the {\ttfamily token} and an {\ttfamily info} object. The {\ttfamily info} object has {\ttfamily title} and {\ttfamily slug} properties with the token content and the slug used for the identifier.

We set by default \href{https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex}{\texttt{ {\ttfamily tabindex=\char`\"{}-\/1\char`\"{}}}} on headers. This marks the headers as focusable elements that are not reachable by keyboard navigation. The effect is that screen readers will read the title content when it\textquotesingle{}s being jumped to. Outside of screen readers, the experience is the same as not setting that attribute. You can override this behavior with the {\ttfamily tab\+Index} option. Set it to {\ttfamily false} to remove the attribute altogether, otherwise the value will be used as attribute value.

Finally, you can customize how the title text is extracted from the markdown-\/it tokens (to later generate the slug). See \href{\#user-friendly-urls}{\texttt{ user-\/friendly U\+R\+Ls}}.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1359}{}\doxysection{User-\/friendly U\+R\+Ls}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1359}
Starting from v5.\+0.\+0, markdown-\/it-\/anchor dropped the \href{https://github.com/jprichardson/string.js}{\texttt{ {\ttfamily string}}} package to retain our core value of being an impartial and secure library. Nevertheless, users looking for backward compatibility may want the old {\ttfamily slugify} function\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm install string}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} \textcolor{keywordtype}{string} = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'string'})}
\DoxyCodeLine{const slugify = \mbox{\hyperlink{markdownItAnchor_8js_ad9a7d92cb87932d25187fdec3ba1b621}{s}} => \textcolor{keywordtype}{string}(\mbox{\hyperlink{markdownItAnchor_8js_ad9a7d92cb87932d25187fdec3ba1b621}{s}}).slugify().\mbox{\hyperlink{errors_8js_a7bbb76897f05bb6d3903da8977bdc33b}{toString}}()}
\DoxyCodeLine{}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}-\/anchor'), \{ slugify \})}
\end{DoxyCode}


Another popular library for this is \href{https://github.com/sindresorhus/slugify}{\texttt{ {\ttfamily @sindresorhus/slugify}}}, which have better Unicode support and other cool features\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm install @sindresorhus/slugify}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} slugify = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'@sindresorhus/slugify'})}
\DoxyCodeLine{}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}-\/anchor'), \{ slugify: \mbox{\hyperlink{markdownItAnchor_8js_ad9a7d92cb87932d25187fdec3ba1b621}{s}} => slugify(\mbox{\hyperlink{markdownItAnchor_8js_ad9a7d92cb87932d25187fdec3ba1b621}{s}}) \})}
\end{DoxyCode}


Additionally, if you want to further customize the title that gets passed to the {\ttfamily slugify} function, you can do so by customizing the {\ttfamily get\+Tokens\+Text} function, that gets the plain text from a list of markdown-\/it inline tokens\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{function} getTokensText (tokens) \{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} tokens}
\DoxyCodeLine{    .filter(token => ![\textcolor{stringliteral}{'html\_inline'}, \textcolor{stringliteral}{'image'}].\mbox{\hyperlink{underscore_2cjs_2index_8js_a706c237dd757e238ad44d7dadd3177d7}{includes}}(token.type))}
\DoxyCodeLine{    .map(\mbox{\hyperlink{_0dlezer_2highlight_2dist_2index_8js_a52b119099ad76203f6bf69c0ab4cc17e}{t}} => \mbox{\hyperlink{_0dlezer_2highlight_2dist_2index_8js_a52b119099ad76203f6bf69c0ab4cc17e}{t}}.content)}
\DoxyCodeLine{    .join(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const} md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it'})()}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'}), \{ getTokensText \})}
\end{DoxyCode}


By default we include only {\ttfamily text} and {\ttfamily code\+\_\+inline} tokens, which appeared to be a sensible approach for the vast majority of use cases.

An alternative approach is to include every token\textquotesingle{}s content except for {\ttfamily html\+\_\+inline} and {\ttfamily image} tokens, which yields the exact same results as the previous approach with a stock markdown-\/it, but would also include custom tokens added by any of your markdown-\/it plugins, which might or might not be desirable for you. Now you have the option!\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1360}{}\doxysection{Manually setting the $<$tt$>$id$<$/tt$>$ attribute}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1360}
You might want to explicitly set the {\ttfamily id} attribute of your headings from the Markdown document, for example to keep them consistent across translations.

markdown-\/it-\/anchor is designed to reuse any existing {\ttfamily id}, making \href{https://www.npmjs.com/package/markdown-it-attrs}{\texttt{ markdown-\/it-\/attrs}} a perfect fit for this use case. Make sure to load it before markdown-\/it-\/anchor!

Then you can do something like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\# Your title \{\#your-\/custom-\/id\}}
\end{DoxyCode}


The anchor link will reuse the {\ttfamily id} that you explicitly defined.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1361}{}\doxysection{Compatible table of contents plugin}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1361}
Looking for an automatic table of contents (T\+OC) generator? Take a look at \href{https://www.npmjs.com/package/markdown-it-toc-done-right}{\texttt{ markdown-\/it-\/toc-\/done-\/right}} it\textquotesingle{}s made from the ground to be a great companion of this plugin.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1362}{}\doxysection{Parsing headings from H\+T\+M\+L blocks}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1362}
markdown-\/it-\/anchor doesn\textquotesingle{}t parse H\+T\+ML blocks, so headings defined in H\+T\+ML blocks will be ignored. If you need to add anchors to both H\+T\+ML headings and Markdown headings, the easiest way would be to do it on the final H\+T\+ML rather than during the Markdown parsing phase\+:

\`{}\`{}`js const \{ parse \} = require(\textquotesingle{}node-\/html-\/parser')

const root = parse(html)

for (const h of root.\+query\+Selector\+All(\textquotesingle{}h1, h2, h3, h4, h5, h6\textquotesingle{})) \{ const slug = h.\+get\+Attribute(\textquotesingle{}id\textquotesingle{}) $\vert$$\vert$ slugify(h.\+text\+Content) h.\+set\+Attribute(\textquotesingle{}id\textquotesingle{}, slug) h.\+inner\+H\+T\+ML = {\ttfamily $<$a href="\#\$\{slug\}$>$\$\{h.\+inner\+H\+T\+ML\}} \}

console.\+log(root.\+to\+String()) 
\begin{DoxyCode}{0}
\DoxyCodeLine{Or with a (not accessible) GitHub-\/style anchor, replace the}
\DoxyCodeLine{`h.innerHTML` part with:}
\DoxyCodeLine{}
\DoxyCodeLine{```js}
\DoxyCodeLine{h.insertAdjacentHTML('afterbegin', `<a class="anchor" aria-\/hidden="true" href="\#\$\{slug\}">🔗</a> `)}
\end{DoxyCode}


While this still needs extra work like handling duplicated slugs and I\+Ds, this should give you a solid base.

That said if you really want to use markdown-\/it-\/anchor for this even though it\textquotesingle{}s not designed to, you can do like npm does with their \href{https://github.com/npm/marky-markdown}{\texttt{ marky-\/markdown}} parser, and \href{https://github.com/npm/marky-markdown/blob/master/lib/plugin/html-heading.js}{\texttt{ transform the {\ttfamily html\+\_\+block} tokens}} into a sequence of {\ttfamily heading\+\_\+open}, {\ttfamily inline}, and {\ttfamily heading\+\_\+close} tokens that can be handled by markdown-\/it-\/anchor\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it'})()}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'@npmcorp/marky-\/markdown/lib/plugin/html-\/heading'}))}
\DoxyCodeLine{  .\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(\mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'}), \mbox{\hyperlink{catharsis_2bin_2parse_8js_ab0ff07ba233223b1d32000392ac9b0ea}{opts}})}
\end{DoxyCode}


While they use regexes to parse the H\+T\+ML and it won\textquotesingle{}t gracefully handle any arbitrary H\+T\+ML, it should work okay for the happy path, which might be good enough for you.

You might also want to check \href{https://github.com/valeriangalliat/markdown-it-anchor/issues/105\#issuecomment-907323858}{\texttt{ this implementation}} which uses \href{https://www.npmjs.com/package/cheerio}{\texttt{ Cheerio}} for a more solid parsing, including support for H\+T\+ML attributes.

The only edge cases I see it failing with are multiple headings defined in the same H\+T\+ML block with arbitrary content between them, or headings where the opening and closing tag are defined in separate {\ttfamily html\+\_\+block} tokens, both which should very rarely happen.

If you need a bulletproof implementation, I would recommend the first H\+T\+ML parser approach I documented instead.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1363}{}\doxysection{Browser example}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1363}
See \href{example.html}{\texttt{ {\ttfamily example.\+html}}}.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1364}{}\doxysection{Permalinks}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1364}
Version 8.\+0.\+0 completely reworked the way permalinks work in order to offer more accessible options out of the box. You can also \href{\#custom-permalink}{\texttt{ make your own permalink}}.

Instead of a single default way of rendering permalinks (which used to have a poor UX on screen readers), we now have multiple styles of permalinks for you to chose from.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} anchor = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'})}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{}
\DoxyCodeLine{md.\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(anchor, \{}
\DoxyCodeLine{  \mbox{\hyperlink{markdownItAnchor_8js_a348f3c8ade2998a2ed59528fa175a791}{permalink}}: anchor.permalink[styleOfPermalink](permalinkOpts)}
\DoxyCodeLine{\})}
\end{DoxyCode}


Here, {\ttfamily style\+Of\+Permalink} is one of the available styles documented below, and {\ttfamily permalink\+Opts} is an options object.



All renderers share a common set of options\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endhead
{\ttfamily class} &The class of the permalink anchor. &{\ttfamily header-\/anchor}  \\\cline{1-3}
{\ttfamily symbol} &The symbol in the permalink anchor. &{\ttfamily \#}  \\\cline{1-3}
{\ttfamily render\+Href} &A custom permalink {\ttfamily href} rendering function. &See \href{permalink.js}{\texttt{ {\ttfamily permalink.\+js}}}  \\\cline{1-3}
{\ttfamily render\+Attrs} &A custom permalink attributes rendering function. &See \href{permalink.js}{\texttt{ {\ttfamily permalink.\+js}}}  \\\cline{1-3}
\end{longtabu}


For the {\ttfamily symbol}, you may want to use the \href{http://graphemica.com/🔗}{\texttt{ link symbol}}, or a symbol from your favorite web font.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1365}{}\doxysubsection{Header link}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1365}
This style wraps the header itself in an anchor link. It doesn\textquotesingle{}t use the {\ttfamily symbol} option as there\textquotesingle{}s no symbol needed in the markup (though you could add it with C\+SS using {\ttfamily \mbox{\hyperlink{underscore-esm-min_8js_a38713f21a521f85af75aa009acbf066d}{before}}} if you like).

It\textquotesingle{}s so simple it doesn\textquotesingle{}t have any behaviour to custom, and it\textquotesingle{}s also accessible out of the box without any further configuration, hence it doesn\textquotesingle{}t have other options than the common ones described above.

You can find this style on the \href{https://developer.mozilla.org/en-US/docs/Web}{\texttt{ M\+DN}} as well as \href{https://httparchive.org/reports/state-of-the-web}{\texttt{ H\+T\+TP Archive}} and their \href{https://almanac.httparchive.org/en/2020/table-of-contents}{\texttt{ Web Almanac}}, which to me is a good sign that this is a thoughtful way of implementing permalinks. This is also the style that I chose for my own \href{https://www.codejam.info/}{\texttt{ blog}}.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endhead
{\ttfamily safari\+Reader\+Fix} &Add a {\ttfamily span} inside the link so Safari shows headings in reader view. &{\ttfamily false} (for backwards compatibility)  \\\cline{1-3}
&See \href{\#common-options}{\texttt{ common options}}. &\\\cline{1-3}
\end{longtabu}



\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} anchor = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'})}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{}
\DoxyCodeLine{md.\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(anchor, \{}
\DoxyCodeLine{  \mbox{\hyperlink{markdownItAnchor_8js_a348f3c8ade2998a2ed59528fa175a791}{permalink}}: anchor.permalink.headerLink()}
\DoxyCodeLine{\})}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{<h2 id="title"><a class="header-\/anchor" href="\#title">Title</a></h2>}
\end{DoxyCode}


The main caveat of this approach is that you can\textquotesingle{}t include links inside headers. If you do, consider the other styles.

Also note that this pattern \href{https://www.leereamsnyder.com/blog/making-headings-with-links-show-up-in-safari-reader}{\texttt{ breaks reader mode in Safari}}, an issue you can also notice on the referenced websites above. This was already \href{https://bugs.webkit.org/show_bug.cgi?id=225609\#c2}{\texttt{ reported to Apple}} but their bug tracker is not public. In the meantime, a fix mentioned in the article above is to insert a {\ttfamily span} inside the link. You can use the {\ttfamily safari\+Reader\+Fix} option to enable it.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} anchor = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'})}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{}
\DoxyCodeLine{md.\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(anchor, \{}
\DoxyCodeLine{  \mbox{\hyperlink{markdownItAnchor_8js_a348f3c8ade2998a2ed59528fa175a791}{permalink}}: anchor.permalink.headerLink(\{ safariReaderFix: \textcolor{keyword}{true} \})}
\DoxyCodeLine{\})}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{<h2 id="title"><a class="header-\/anchor" href="\#title"><span>Title</span></a></h2>}
\end{DoxyCode}
\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1366}{}\doxysubsection{Link after header}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1366}
If you want to customize further the screen reader experience of your permalinks, this style gives you much more freedom than the \href{\#header-link}{\texttt{ header link}}.

It works by leaving the header itself alone, and adding the permalink {\itshape after} it, giving you different methods of customizing the assistive text. It makes the permalink symbol {\ttfamily aria-\/hidden} to not pollute the experience, and leverages a {\ttfamily visually\+Hidden\+Class} to hide the assistive text from the visual experience.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endhead
{\ttfamily style} &The (sub) style of link, one of {\ttfamily visually-\/hidden}, {\ttfamily aria-\/label}, {\ttfamily aria-\/describedby} or {\ttfamily aria-\/labelledby}. &{\ttfamily visually-\/hidden}  \\\cline{1-3}
{\ttfamily assistive\+Text} &A function that takes the title and returns the assistive text. &{\ttfamily undefined}, required for {\ttfamily visually-\/hidden} and {\ttfamily aria-\/label} styles  \\\cline{1-3}
{\ttfamily visually\+Hidden\+Class} &The class you use to make an element visually hidden. &{\ttfamily undefined}, required for {\ttfamily visually-\/hidden} style  \\\cline{1-3}
{\ttfamily space} &Add a space between the assistive text and the permalink symbol. &{\ttfamily true}  \\\cline{1-3}
{\ttfamily placement} &Placement of the permalink symbol relative to the assistive text, can be {\ttfamily before} or {\ttfamily after} the header. &{\ttfamily after}  \\\cline{1-3}
{\ttfamily wrapper} &Opening and closing wrapper string, e.\+g. `\mbox{[}'\textquotesingle{}, \textquotesingle{}\textquotesingle{}\mbox{]}{\ttfamily .$<$/td$>$ $<$td class=\char`\"{}markdown\+Table\+Body\+None\char`\"{}$>$}null\`{}  \\\cline{1-3}
&See \href{\#common-options}{\texttt{ common options}}. &\\\cline{1-3}
\end{longtabu}



\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} anchor = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'})}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{}
\DoxyCodeLine{md.\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(anchor, \{}
\DoxyCodeLine{  \mbox{\hyperlink{markdownItAnchor_8js_a348f3c8ade2998a2ed59528fa175a791}{permalink}}: anchor.permalink.linkAfterHeader(\{}
\DoxyCodeLine{    style: \textcolor{stringliteral}{'visually-\/hidden'},}
\DoxyCodeLine{    assistiveText: \mbox{\hyperlink{bin_2marked_8js_a42954581cb07bf3f6282858111f88ca9}{title}} => `Permalink to “\$\{\mbox{\hyperlink{bin_2marked_8js_a42954581cb07bf3f6282858111f88ca9}{title}}\}”`,}
\DoxyCodeLine{    visuallyHiddenClass: \textcolor{stringliteral}{'visually-\/hidden'},}
\DoxyCodeLine{    wrapper: [\textcolor{stringliteral}{'<div class="wrapper">'}, \textcolor{stringliteral}{'</div>'}]}
\DoxyCodeLine{  \})}
\DoxyCodeLine{\})}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{<div class="wrapper">}
\DoxyCodeLine{  <h2 id="title">Title</h2>}
\DoxyCodeLine{  <a class="header-\/anchor" href="\#title">}
\DoxyCodeLine{    <span class="visually-\/hidden">Permalink to “Title”</span>}
\DoxyCodeLine{    <span aria-\/hidden="true">\#</span>}
\DoxyCodeLine{  </a>}
\DoxyCodeLine{</div>}
\end{DoxyCode}


By using a visually hidden element for the assistive text, we make sure that the assistive text can be picked up by translation services, as most of the popular translation services (including Google Translate) currently ignore {\ttfamily aria-\/label}.

If you prefer an alternative method for the assistive text, see other styles\+:

$<$details$>$

This removes the need from a visually hidden {\ttfamily span}, but will likely hurt the permalink experience when using a screen reader through a translation service.

\`{}\`{}`js const anchor = require(\textquotesingle{}markdown-\/it-\/anchor') const md = require(\textquotesingle{}markdown-\/it\textquotesingle{})()

md.\+use(anchor, \{ permalink\+: anchor.\+permalink.\+link\+After\+Header(\{ style\+: \textquotesingle{}aria-\/label\textquotesingle{} assistive\+Text\+: title =$>$ {\ttfamily Permalink to “\$\{title\}”} \}) \}) 
\begin{DoxyCode}{0}
\DoxyCodeLine{```html}
\DoxyCodeLine{<h2 id="title">Title</h2>}
\DoxyCodeLine{<a class="header-\/anchor" href="\#title" aria-\/label="Permalink to “Title”">\#</a>}
\end{DoxyCode}


$<$/details$>$

$<$details$>$


\begin{DoxyCode}{0}
\DoxyCodeLine{aria-\/describedby}
\end{DoxyCode}
 and 
\begin{DoxyCode}{0}
\DoxyCodeLine{aria-\/labelledby}
\end{DoxyCode}
 variants 

This removes the need to customize the assistive text to your locale and doesn\textquotesingle{}t need a visually hidden {\ttfamily span} either, but since the anchor will be described by just the text of the title without any context, it might be confusing.

\`{}\`{}`js const anchor = require(\textquotesingle{}markdown-\/it-\/anchor') const md = require(\textquotesingle{}markdown-\/it\textquotesingle{})()

md.\+use(anchor, \{ permalink\+: anchor.\+permalink.\+link\+After\+Header(\{ style\+: \textquotesingle{}aria-\/describedby\textquotesingle{} // Or {\ttfamily aria-\/labelledby} \}) \}) 
\begin{DoxyCode}{0}
\DoxyCodeLine{```html}
\DoxyCodeLine{<h2 id="title">Title</h2>}
\DoxyCodeLine{<a class="header-\/anchor" href="\#title" aria-\/describedby="title">\#</a>}
\end{DoxyCode}


$<$/details$>$\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1367}{}\doxysubsection{Link inside header}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1367}
This is the equivalent of the default permalink in previous versions. The reason it\textquotesingle{}s not the first one in the list is because this method has accessibility issues.

If you use a symbol like just {\ttfamily \#} without adding any markup around, screen readers will read it as part of every heading (in the case of {\ttfamily \#}, it could be read \char`\"{}pound\char`\"{}, \char`\"{}number\char`\"{} or \char`\"{}number sign\char`\"{}) meaning that if you title is \char`\"{}my beautiful title\char`\"{}, it will read \char`\"{}number sign my
beautiful title\char`\"{} for example. For other common symbols, {\ttfamily 🔗} is usually read as \char`\"{}link symbol\char`\"{} and {\ttfamily ¶} as \char`\"{}pilcrow\char`\"{}.

Additionally, screen readers users commonly request the list of all links in the page, so they\textquotesingle{}ll be flooded with \char`\"{}number sign, number sign,
number sign\char`\"{} for each of your headings.

I would highly recommend using one of the markups above which have a better experience, but if you really want to use this markup, make sure to pass accessible H\+T\+ML as {\ttfamily symbol} to make things usable, like in the example below, but even that has some flaws.

With that said, this permalink allows the following options\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default  }\\\cline{1-3}
\endhead
{\ttfamily space} &Add a space between the header text and the permalink symbol. Set it to a string to customize the space (e.\+g. {\ttfamily ~}). &{\ttfamily true}  \\\cline{1-3}
{\ttfamily placement} &Placement of the permalink, can be {\ttfamily before} or {\ttfamily after} the header. This option used to be called {\ttfamily permalink\+Before}. &{\ttfamily after}  \\\cline{1-3}
{\ttfamily aria\+Hidden} &Whether to add {\ttfamily aria-\/hidden=\char`\"{}true\char`\"{}}, see \href{\#aria-hidden}{\texttt{ A\+R\+IA hidden}}. &{\ttfamily false}  \\\cline{1-3}
&See \href{\#common-options}{\texttt{ common options}}. &\\\cline{1-3}
\end{longtabu}


\`{}\`{}`js const anchor = require(\textquotesingle{}markdown-\/it-\/anchor') const md = require(\textquotesingle{}markdown-\/it\textquotesingle{})()

md.\+use(anchor, \{ permalink\+: anchor.\+permalink.\+link\+Inside\+Header(\{ symbol\+: \`{} Jump to heading \# `, placement\+: \textquotesingle{}before' \}) \}) 
\begin{DoxyCode}{0}
\DoxyCodeLine{```html}
\DoxyCodeLine{<h2 id="title">}
\DoxyCodeLine{  <a class="header-\/anchor" href="\#title">}
\DoxyCodeLine{    <span class="visually-\/hidden">Jump to heading</span>}
\DoxyCodeLine{    <span aria-\/hidden="true">\#</span>}
\DoxyCodeLine{  </a>}
\DoxyCodeLine{  Title}
\DoxyCodeLine{</h2>}
\end{DoxyCode}


While this example allows more accessible anchors with the same markup as previous versions of markdown-\/it-\/anchor, it\textquotesingle{}s still not ideal. The assistive text for permalinks will be read as part of the heading when listing all the titles of the page, e.\+g. \char`\"{}jump to heading title 1, jump
to heading title 2\char`\"{} and so on. Also that assistive text is not very useful when listing the links in the page (which will read \char`\"{}jump to
heading, jump to heading, jump to heading\char`\"{} for each of your permalinks).\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1368}{}\doxysubsection{A\+R\+I\+A hidden}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1368}
This is just an alias for \href{\#link-inside-header}{\texttt{ {\ttfamily link\+Inside\+Header}}} with {\ttfamily aria\+Hidden\+: true} by default, to mimic Git\+Hub\textquotesingle{}s way of rendering permalinks.

Setting {\ttfamily aria-\/hidden=\char`\"{}true\char`\"{}} makes the permalink explicitly inaccessible instead of having the permalink and its symbol being read by screen readers as part of every single headings (which was a pretty terrible experience).


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{const} anchor = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}(\textcolor{stringliteral}{'markdown-\/it-\/anchor'})}
\DoxyCodeLine{const md = \mbox{\hyperlink{dist_2markdown-it_8js_a4b4eb847520ff4e45de16db801e26133}{require}}('\mbox{\hyperlink{readme_8js_a1f2a5a833c7c6434ca1f1e5ad66188c9}{markdown}}-\/\mbox{\hyperlink{lodash_8min_8js_a53bb00c7767c3df3cdef39d2863ce11f}{it}}')()}
\DoxyCodeLine{}
\DoxyCodeLine{md.\mbox{\hyperlink{dist_2markdown-it_8js_afdc31efea6eaa6cb360d780f8fd31efa}{use}}(anchor, \{}
\DoxyCodeLine{  \mbox{\hyperlink{markdownItAnchor_8js_a348f3c8ade2998a2ed59528fa175a791}{permalink}}: anchor.permalink.ariaHidden(\{}
\DoxyCodeLine{    placement: \textcolor{stringliteral}{'before'}}
\DoxyCodeLine{  \})}
\DoxyCodeLine{\})}
\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{<h2 id="title"><a class="header-\/anchor" href="\#title" aria-\/hidden="true">\#</a> Title</h2>}
\end{DoxyCode}


While no experience might be arguably better than a bad experience, I would instead recommend using one of the above renderers to provide an accessible experience. My favorite one is the \href{\#header-link}{\texttt{ header link}}, which is also the simplest one.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1369}{}\doxysubsection{Custom permalink}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1369}
If none of those options suit you, you can always make your own renderer! Take inspiration from \href{permalink.js}{\texttt{ the code behind all permalinks}}.

The signature of the function you pass in the {\ttfamily permalink} option is the following\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{function} renderPermalink (slug, \mbox{\hyperlink{catharsis_2bin_2parse_8js_ab0ff07ba233223b1d32000392ac9b0ea}{opts}}, \mbox{\hyperlink{_0dcodemirror_2language_2dist_2index_8js_a9c9547f1942d13b63294a645805217f4}{state}}, idx) \{\}}
\end{DoxyCode}


Where {\ttfamily opts} are the markdown-\/it-\/anchor options, {\ttfamily state} is a markdown-\/it \href{https://github.com/markdown-it/markdown-it}{\texttt{ {\ttfamily State\+Core}}} instance, and {\ttfamily idx} is the index of the {\ttfamily heading\+\_\+open} token in the {\ttfamily state.\+tokens} array. That array contains \href{https://markdown-it.github.io/markdown-it/\#Token}{\texttt{ {\ttfamily Token}}} objects.

To make sense of the \char`\"{}token stream\char`\"{} and the way token objects are organized, you will probably want to read the \href{https://github.com/markdown-it/markdown-it/blob/master/docs/architecture.md}{\texttt{ markdown-\/it design principles}} page.

This function can freely modify the token stream ({\ttfamily state.\+tokens}), usually around the given {\ttfamily idx}, to construct the anchor.

Because of the way the token stream works, a {\ttfamily heading\+\_\+open} token is usually followed by a {\ttfamily inline} token that contains the actual text (and inline markup) of the heading, and finally a {\ttfamily heading\+\_\+close} token. This is why you\textquotesingle{}ll see most built-\/in permalink renderers touch {\ttfamily state.\+tokens\mbox{[}idx + 1\mbox{]}}, because they update the contents of the {\ttfamily inline} token that follows a {\ttfamily heading\+\_\+open}.\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1370}{}\doxysection{Debugging}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1370}
If you want to debug this library more easily, we support source maps.

Use the \href{https://www.npmjs.com/package/source-map-support}{\texttt{ source-\/map-\/support}} module to enable it with Node.\+js.


\begin{DoxyCode}{0}
\DoxyCodeLine{node -\/r source-\/map-\/support/register your-\/script.js}
\end{DoxyCode}
\hypertarget{md_node_modules_markdown-it-anchor_README_autotoc_md1371}{}\doxysection{Development}\label{md_node_modules_markdown-it-anchor_README_autotoc_md1371}

\begin{DoxyCode}{0}
\DoxyCodeLine{\# Build the library in the `dist/` directory.}
\DoxyCodeLine{npm run build}
\DoxyCodeLine{}
\DoxyCodeLine{\# Watch file changes to update `dist/`.}
\DoxyCodeLine{npm run dev}
\DoxyCodeLine{}
\DoxyCodeLine{\# Run tests, will use the build version so make sure to build after}
\DoxyCodeLine{\# making changes.}
\DoxyCodeLine{npm test}
\end{DoxyCode}
 