<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: markdown-it-anchor &lt;a href=&quot;https://www.npmjs.org/package/markdown-it-anchor&quot;&gt;&lt;img src=&quot;http://img.shields.io/npm/v/markdown-it-anchor.svg?style=flat-square&quot; alt=&quot;npm version&quot;/&gt;&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">markdown-it-anchor <a href="https://www.npmjs.org/package/markdown-it-anchor"><object type="image/svg+xml" data="http://img.shields.io/npm/v/markdown-it-anchor.svg?style=flat-square" style="pointer-events: none;">npm version</object></a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">aria-label</div>
</div><!-- fragment --><p> variant</p>
<blockquote class="doxtable">
<p>A markdown-it plugin that adds an <code>id</code> attribute to headings and optionally permalinks. </p>
</blockquote>
<p>English | 中文 (v7.0.1)</p>
<h1><a class="anchor" id="autotoc_md728"></a>
Overview</h1>
<p>This plugin adds an <code>id</code> attribute to headings, e.g. <code>## Foo</code> becomes <code>&lt;h2 id="foo"&gt;Foo&lt;/h2&gt;</code>.</p>
<p>Optionally it can also include <a href="#permalinks">permalinks</a>, e.g. <code>&lt;h2 id="foo"&gt;&lt;a class="header-anchor" href="#foo"&gt;Foo&lt;/a&gt;&lt;/h2&gt;</code> and a bunch of other variants!</p>
<ul>
<li><a href="#usage"><b>Usage</b></a></li>
<li><a href="#user-friendly-urls">User-friendly URLs</a></li>
<li><a href="#manually-setting-the-id-attribute">Manually setting the <code>id</code> attribute</a></li>
<li><a href="#compatible-table-of-contents-plugin">Compatible table of contents plugin</a></li>
<li><a href="#parsing-headings-from-html-blocks">Parsing headings from HTML blocks</a></li>
<li><a href="#browser-example">Browser example</a></li>
<li><a href="#permalinks"><b>Permalinks</b></a><ul>
<li><a href="#header-link">Header link</a></li>
<li><a href="#link-after-header">Link after header</a></li>
<li><a href="#link-inside-header">Link inside header</a></li>
<li><a href="#aria-hidden">ARIA hidden</a></li>
<li><a href="#custom-permalink">Custom permalink</a></li>
</ul>
</li>
<li><a href="#debugging">Debugging</a></li>
<li><a href="#development">Development</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md729"></a>
Usage</h1>
<div class="fragment"><div class="line"><span class="keyword">const</span> md = require(<span class="stringliteral">&#39;markdown-it&#39;</span>)()</div>
<div class="line">  .use(require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>), opts)</div>
</div><!-- fragment --><p>See a <a href="https://jsfiddle.net/9ukc8dy6/">demo as JSFiddle</a>.</p>
<p>The <code>opts</code> object can contain:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Default  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>level</code> </td><td class="markdownTableBodyNone">Minimum level to apply anchors, or array of selected levels. </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>permalink</code> </td><td class="markdownTableBodyNone">A function to render permalinks, see <a href="#permalinks">permalinks</a> below. </td><td class="markdownTableBodyNone"><code>undefined</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>slugify</code> </td><td class="markdownTableBodyNone">A custom slugification function. </td><td class="markdownTableBodyNone">See <a href="https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js#L3"><code>index.js</code></a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>callback</code> </td><td class="markdownTableBodyNone">Called with token and info after rendering. </td><td class="markdownTableBodyNone"><code>undefined</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>getTokensText</code> </td><td class="markdownTableBodyNone">A custom function to get the text contents of the title from its tokens. </td><td class="markdownTableBodyNone">See <a href="https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js#L5"><code>index.js</code></a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>tabIndex</code> </td><td class="markdownTableBodyNone">Value of the <code>tabindex</code> attribute on headings, set to <code>false</code> to disable. </td><td class="markdownTableBodyNone"><code>-1</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>uniqueSlugStartIndex</code> </td><td class="markdownTableBodyNone">Index to start with when making duplicate slugs unique. </td><td class="markdownTableBodyNone">1  </td></tr>
</table>
<p>All headers greater than the minimum <code>level</code> will have an <code>id</code> attribute with a slug of their content. For example, you can set <code>level</code> to 2 to add anchors to all headers but <code>h1</code>. You can also pass an array of header levels to apply the anchor, like <code>[2, 3]</code> to have an anchor on only level 2 and 3 headers.</p>
<p>If a <code>permalink</code> renderer is given, it will be called for each matching header to add a permalink. See <a href="#permalinks">permalinks</a> below.</p>
<p>If a <code>slugify</code> function is given, you can decide how to transform a heading text to a URL slug. See <a href="#user-friendly-urls">user-friendly URLs</a>.</p>
<p>The <code>callback</code> option is a function that will be called at the end of rendering with the <code>token</code> and an <code>info</code> object. The <code>info</code> object has <code>title</code> and <code>slug</code> properties with the token content and the slug used for the identifier.</p>
<p>We set by default <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex"><code>tabindex="-1"</code></a> on headers. This marks the headers as focusable elements that are not reachable by keyboard navigation. The effect is that screen readers will read the title content when it's being jumped to. Outside of screen readers, the experience is the same as not setting that attribute. You can override this behavior with the <code>tabIndex</code> option. Set it to <code>false</code> to remove the attribute altogether, otherwise the value will be used as attribute value.</p>
<p>Finally, you can customize how the title text is extracted from the markdown-it tokens (to later generate the slug). See <a href="#user-friendly-urls">user-friendly URLs</a>.</p>
<h1><a class="anchor" id="autotoc_md730"></a>
User-friendly URLs</h1>
<p>Starting from v5.0.0, markdown-it-anchor dropped the <a href="https://github.com/jprichardson/string.js"><code>string</code></a> package to retain our core value of being an impartial and secure library. Nevertheless, users looking for backward compatibility may want the old <code>slugify</code> function:</p>
<div class="fragment"><div class="line">npm install string</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> = require(<span class="stringliteral">&#39;string&#39;</span>)</div>
<div class="line">const slugify = s =&gt; <span class="keywordtype">string</span>(s).slugify().toString()</div>
<div class="line"> </div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line">  .use(require(&#39;markdown-it-anchor&#39;), { slugify })</div>
</div><!-- fragment --><p>Another popular library for this is <a href="https://github.com/sindresorhus/slugify"><code>@sindresorhus/slugify</code></a>, which have better Unicode support and other cool features:</p>
<div class="fragment"><div class="line">npm install @sindresorhus/slugify</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">const</span> slugify = require(<span class="stringliteral">&#39;@sindresorhus/slugify&#39;</span>)</div>
<div class="line"> </div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line">  .use(require(&#39;markdown-it-anchor&#39;), { slugify: s =&gt; slugify(s) })</div>
</div><!-- fragment --><p>Additionally, if you want to further customize the title that gets passed to the <code>slugify</code> function, you can do so by customizing the <code>getTokensText</code> function, that gets the plain text from a list of markdown-it inline tokens:</p>
<div class="fragment"><div class="line"><span class="keyword">function</span> getTokensText (tokens) {</div>
<div class="line">  <span class="keywordflow">return</span> tokens</div>
<div class="line">    .filter(token =&gt; ![<span class="stringliteral">&#39;html_inline&#39;</span>, <span class="stringliteral">&#39;image&#39;</span>].includes(token.type))</div>
<div class="line">    .map(t =&gt; t.content)</div>
<div class="line">    .join(<span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> md = require(<span class="stringliteral">&#39;markdown-it&#39;</span>)()</div>
<div class="line">  .use(require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>), { getTokensText })</div>
</div><!-- fragment --><p>By default we include only <code>text</code> and <code>code_inline</code> tokens, which appeared to be a sensible approach for the vast majority of use cases.</p>
<p>An alternative approach is to include every token's content except for <code>html_inline</code> and <code>image</code> tokens, which yields the exact same results as the previous approach with a stock markdown-it, but would also include custom tokens added by any of your markdown-it plugins, which might or might not be desirable for you. Now you have the option!</p>
<h1><a class="anchor" id="autotoc_md731"></a>
Manually setting the &lt;tt&gt;id&lt;/tt&gt; attribute</h1>
<p>You might want to explicitly set the <code>id</code> attribute of your headings from the Markdown document, for example to keep them consistent across translations.</p>
<p>markdown-it-anchor is designed to reuse any existing <code>id</code>, making <a href="https://www.npmjs.com/package/markdown-it-attrs">markdown-it-attrs</a> a perfect fit for this use case. Make sure to load it before markdown-it-anchor!</p>
<p>Then you can do something like this:</p>
<div class="fragment"><div class="line"># Your title {#your-custom-id}</div>
</div><!-- fragment --><p>The anchor link will reuse the <code>id</code> that you explicitly defined.</p>
<h1><a class="anchor" id="autotoc_md732"></a>
Compatible table of contents plugin</h1>
<p>Looking for an automatic table of contents (TOC) generator? Take a look at <a href="https://www.npmjs.com/package/markdown-it-toc-done-right">markdown-it-toc-done-right</a> it's made from the ground to be a great companion of this plugin.</p>
<h1><a class="anchor" id="autotoc_md733"></a>
Parsing headings from HTML blocks</h1>
<p>markdown-it-anchor doesn't parse HTML blocks, so headings defined in HTML blocks will be ignored. If you need to add anchors to both HTML headings and Markdown headings, the easiest way would be to do it on the final HTML rather than during the Markdown parsing phase:</p>
<p>``&lsquo;js const { parse } = require('node-html-parser&rsquo;)</p>
<p>const root = parse(html)</p>
<p>for (const h of root.querySelectorAll('h1, h2, h3, h4, h5, h6')) { const slug = h.getAttribute('id') || slugify(h.textContent) h.setAttribute('id', slug) h.innerHTML = <code>&lt;a href="#${slug}&gt;${h.innerHTML}</code> }</p>
<p>console.log(root.toString()) </p><div class="fragment"><div class="line">Or with a (not accessible) GitHub-style anchor, replace the</div>
<div class="line">`h.innerHTML` part with:</div>
<div class="line"> </div>
<div class="line">```js</div>
<div class="line">h.insertAdjacentHTML(&#39;afterbegin&#39;, `&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#${slug}&quot;&gt;🔗&lt;/a&gt; `)</div>
</div><!-- fragment --><p>While this still needs extra work like handling duplicated slugs and IDs, this should give you a solid base.</p>
<p>That said if you really want to use markdown-it-anchor for this even though it's not designed to, you can do like npm does with their <a href="https://github.com/npm/marky-markdown">marky-markdown</a> parser, and <a href="https://github.com/npm/marky-markdown/blob/master/lib/plugin/html-heading.js">transform the <code>html_block</code> tokens</a> into a sequence of <code>heading_open</code>, <code>inline</code>, and <code>heading_close</code> tokens that can be handled by markdown-it-anchor:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> md = require(<span class="stringliteral">&#39;markdown-it&#39;</span>)()</div>
<div class="line">  .use(require(<span class="stringliteral">&#39;@npmcorp/marky-markdown/lib/plugin/html-heading&#39;</span>))</div>
<div class="line">  .use(require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>), opts)</div>
</div><!-- fragment --><p>While they use regexes to parse the HTML and it won't gracefully handle any arbitrary HTML, it should work okay for the happy path, which might be good enough for you.</p>
<p>You might also want to check <a href="https://github.com/valeriangalliat/markdown-it-anchor/issues/105#issuecomment-907323858">this implementation</a> which uses <a href="https://www.npmjs.com/package/cheerio">Cheerio</a> for a more solid parsing, including support for HTML attributes.</p>
<p>The only edge cases I see it failing with are multiple headings defined in the same HTML block with arbitrary content between them, or headings where the opening and closing tag are defined in separate <code>html_block</code> tokens, both which should very rarely happen.</p>
<p>If you need a bulletproof implementation, I would recommend the first HTML parser approach I documented instead.</p>
<h1><a class="anchor" id="autotoc_md734"></a>
Browser example</h1>
<p>See <a href="example.html"><code>example.html</code></a>.</p>
<h1><a class="anchor" id="autotoc_md735"></a>
Permalinks</h1>
<p>Version 8.0.0 completely reworked the way permalinks work in order to offer more accessible options out of the box. You can also <a href="#custom-permalink">make your own permalink</a>.</p>
<p>Instead of a single default way of rendering permalinks (which used to have a poor UX on screen readers), we now have multiple styles of permalinks for you to chose from.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> anchor = require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>)</div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line"> </div>
<div class="line">md.use(anchor, {</div>
<div class="line">  permalink: anchor.permalink[styleOfPermalink](permalinkOpts)</div>
<div class="line">})</div>
</div><!-- fragment --><p>Here, <code>styleOfPermalink</code> is one of the available styles documented below, and <code>permalinkOpts</code> is an options object.</p>
<div id="common-options"></div><p>All renderers share a common set of options:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Default  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>class</code> </td><td class="markdownTableBodyNone">The class of the permalink anchor. </td><td class="markdownTableBodyNone"><code>header-anchor</code>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>symbol</code> </td><td class="markdownTableBodyNone">The symbol in the permalink anchor. </td><td class="markdownTableBodyNone"><code>#</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>renderHref</code> </td><td class="markdownTableBodyNone">A custom permalink <code>href</code> rendering function. </td><td class="markdownTableBodyNone">See <a href="permalink.js"><code>permalink.js</code></a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>renderAttrs</code> </td><td class="markdownTableBodyNone">A custom permalink attributes rendering function. </td><td class="markdownTableBodyNone">See <a href="permalink.js"><code>permalink.js</code></a>  </td></tr>
</table>
<p>For the <code>symbol</code>, you may want to use the <a href="http://graphemica.com/🔗">link symbol</a>, or a symbol from your favorite web font.</p>
<h2><a class="anchor" id="autotoc_md736"></a>
Header link</h2>
<p>This style wraps the header itself in an anchor link. It doesn't use the <code>symbol</code> option as there's no symbol needed in the markup (though you could add it with CSS using <code>::before</code> if you like).</p>
<p>It's so simple it doesn't have any behaviour to custom, and it's also accessible out of the box without any further configuration, hence it doesn't have other options than the common ones described above.</p>
<p>You can find this style on the <a href="https://developer.mozilla.org/en-US/docs/Web">MDN</a> as well as <a href="https://httparchive.org/reports/state-of-the-web">HTTP Archive</a> and their <a href="https://almanac.httparchive.org/en/2020/table-of-contents">Web Almanac</a>, which to me is a good sign that this is a thoughtful way of implementing permalinks. This is also the style that I chose for my own <a href="https://www.codejam.info/">blog</a>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Default  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>safariReaderFix</code> </td><td class="markdownTableBodyNone">Add a <code>span</code> inside the link so Safari shows headings in reader view. </td><td class="markdownTableBodyNone"><code>false</code> (for backwards compatibility)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">See <a href="#common-options">common options</a>. </td><td class="markdownTableBodyNone"></td></tr>
</table>
<div class="fragment"><div class="line"><span class="keyword">const</span> anchor = require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>)</div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line"> </div>
<div class="line">md.use(anchor, {</div>
<div class="line">  permalink: anchor.permalink.headerLink()</div>
<div class="line">})</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;h2 id=&quot;title&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot;&gt;Title&lt;/a&gt;&lt;/h2&gt;</div>
</div><!-- fragment --><p>The main caveat of this approach is that you can't include links inside headers. If you do, consider the other styles.</p>
<p>Also note that this pattern <a href="https://www.leereamsnyder.com/blog/making-headings-with-links-show-up-in-safari-reader">breaks reader mode in Safari</a>, an issue you can also notice on the referenced websites above. This was already <a href="https://bugs.webkit.org/show_bug.cgi?id=225609#c2">reported to Apple</a> but their bug tracker is not public. In the meantime, a fix mentioned in the article above is to insert a <code>span</code> inside the link. You can use the <code>safariReaderFix</code> option to enable it.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> anchor = require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>)</div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line"> </div>
<div class="line">md.use(anchor, {</div>
<div class="line">  permalink: anchor.permalink.headerLink({ safariReaderFix: <span class="keyword">true</span> })</div>
<div class="line">})</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;h2 id=&quot;title&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot;&gt;&lt;span&gt;Title&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md737"></a>
Link after header</h2>
<p>If you want to customize further the screen reader experience of your permalinks, this style gives you much more freedom than the <a href="#header-link">header link</a>.</p>
<p>It works by leaving the header itself alone, and adding the permalink <em>after</em> it, giving you different methods of customizing the assistive text. It makes the permalink symbol <code>aria-hidden</code> to not pollute the experience, and leverages a <code>visuallyHiddenClass</code> to hide the assistive text from the visual experience.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Default  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>style</code> </td><td class="markdownTableBodyNone">The (sub) style of link, one of <code>visually-hidden</code>, <code>aria-label</code>, <code>aria-describedby</code> or <code>aria-labelledby</code>. </td><td class="markdownTableBodyNone"><code>visually-hidden</code>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>assistiveText</code> </td><td class="markdownTableBodyNone">A function that takes the title and returns the assistive text. </td><td class="markdownTableBodyNone"><code>undefined</code>, required for <code>visually-hidden</code> and <code>aria-label</code> styles  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>visuallyHiddenClass</code> </td><td class="markdownTableBodyNone">The class you use to make an element visually hidden. </td><td class="markdownTableBodyNone"><code>undefined</code>, required for <code>visually-hidden</code> style  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>space</code> </td><td class="markdownTableBodyNone">Add a space between the assistive text and the permalink symbol. </td><td class="markdownTableBodyNone"><code>true</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>placement</code> </td><td class="markdownTableBodyNone">Placement of the permalink symbol relative to the assistive text, can be <code>before</code> or <code>after</code> the header. </td><td class="markdownTableBodyNone"><code>after</code>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>wrapper</code> </td><td class="markdownTableBodyNone">Opening and closing wrapper string, e.g. &lsquo;[&rsquo;<div class="wrapper">', '</div>']<code>.&lt;/td&gt; &lt;td class="markdownTableBodyNone"&gt;</code>null`  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">See <a href="#common-options">common options</a>. </td><td class="markdownTableBodyNone"></td></tr>
</table>
<div class="fragment"><div class="line"><span class="keyword">const</span> anchor = require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>)</div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line"> </div>
<div class="line">md.use(anchor, {</div>
<div class="line">  permalink: anchor.permalink.linkAfterHeader({</div>
<div class="line">    style: <span class="stringliteral">&#39;visually-hidden&#39;</span>,</div>
<div class="line">    assistiveText: title =&gt; `Permalink to “${title}”`,</div>
<div class="line">    visuallyHiddenClass: <span class="stringliteral">&#39;visually-hidden&#39;</span>,</div>
<div class="line">    wrapper: [<span class="stringliteral">&#39;&lt;div class=&quot;wrapper&quot;&gt;&#39;</span>, <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>]</div>
<div class="line">  })</div>
<div class="line">})</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;div class=&quot;wrapper&quot;&gt;</div>
<div class="line">  &lt;h2 id=&quot;title&quot;&gt;Title&lt;/h2&gt;</div>
<div class="line">  &lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot;&gt;</div>
<div class="line">    &lt;span class=&quot;visually-hidden&quot;&gt;Permalink to “Title”&lt;/span&gt;</div>
<div class="line">    &lt;span aria-hidden=&quot;true&quot;&gt;#&lt;/span&gt;</div>
<div class="line">  &lt;/a&gt;</div>
<div class="line">&lt;/div&gt;</div>
</div><!-- fragment --><p>By using a visually hidden element for the assistive text, we make sure that the assistive text can be picked up by translation services, as most of the popular translation services (including Google Translate) currently ignore <code>aria-label</code>.</p>
<p>If you prefer an alternative method for the assistive text, see other styles:</p>
<p>&lt;details&gt;</p>
<p>This removes the need from a visually hidden <code>span</code>, but will likely hurt the permalink experience when using a screen reader through a translation service.</p>
<p>``&lsquo;js const anchor = require('markdown-it-anchor&rsquo;) const md = require('markdown-it')()</p>
<p>md.use(anchor, { permalink: anchor.permalink.linkAfterHeader({ style: 'aria-label' assistiveText: title =&gt; <code>Permalink to “${title}”</code> }) }) </p><div class="fragment"><div class="line">```html</div>
<div class="line">&lt;h2 id=&quot;title&quot;&gt;Title&lt;/h2&gt;</div>
<div class="line">&lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot; aria-label=&quot;Permalink to “Title”&quot;&gt;#&lt;/a&gt;</div>
</div><!-- fragment --><p>&lt;/details&gt;</p>
<p>&lt;details&gt;</p>
<div class="fragment"><div class="line">aria-describedby</div>
</div><!-- fragment --><p> and </p><div class="fragment"><div class="line">aria-labelledby</div>
</div><!-- fragment --><p> variants </p>
<p>This removes the need to customize the assistive text to your locale and doesn't need a visually hidden <code>span</code> either, but since the anchor will be described by just the text of the title without any context, it might be confusing.</p>
<p>``&lsquo;js const anchor = require('markdown-it-anchor&rsquo;) const md = require('markdown-it')()</p>
<p>md.use(anchor, { permalink: anchor.permalink.linkAfterHeader({ style: 'aria-describedby' // Or <code>aria-labelledby</code> }) }) </p><div class="fragment"><div class="line">```html</div>
<div class="line">&lt;h2 id=&quot;title&quot;&gt;Title&lt;/h2&gt;</div>
<div class="line">&lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot; aria-describedby=&quot;title&quot;&gt;#&lt;/a&gt;</div>
</div><!-- fragment --><p>&lt;/details&gt;</p>
<h2><a class="anchor" id="autotoc_md738"></a>
Link inside header</h2>
<p>This is the equivalent of the default permalink in previous versions. The reason it's not the first one in the list is because this method has accessibility issues.</p>
<p>If you use a symbol like just <code>#</code> without adding any markup around, screen readers will read it as part of every heading (in the case of <code>#</code>, it could be read "pound", "number" or "number sign") meaning that if you title is "my beautiful title", it will read "number sign my
beautiful title" for example. For other common symbols, <code>🔗</code> is usually read as "link symbol" and <code>¶</code> as "pilcrow".</p>
<p>Additionally, screen readers users commonly request the list of all links in the page, so they'll be flooded with "number sign, number sign,
number sign" for each of your headings.</p>
<p>I would highly recommend using one of the markups above which have a better experience, but if you really want to use this markup, make sure to pass accessible HTML as <code>symbol</code> to make things usable, like in the example below, but even that has some flaws.</p>
<p>With that said, this permalink allows the following options:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Default  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>space</code> </td><td class="markdownTableBodyNone">Add a space between the header text and the permalink symbol. Set it to a string to customize the space (e.g. <code>&#160;</code>). </td><td class="markdownTableBodyNone"><code>true</code>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>placement</code> </td><td class="markdownTableBodyNone">Placement of the permalink, can be <code>before</code> or <code>after</code> the header. This option used to be called <code>permalinkBefore</code>. </td><td class="markdownTableBodyNone"><code>after</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ariaHidden</code> </td><td class="markdownTableBodyNone">Whether to add <code>aria-hidden="true"</code>, see <a href="#aria-hidden">ARIA hidden</a>. </td><td class="markdownTableBodyNone"><code>false</code>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">See <a href="#common-options">common options</a>. </td><td class="markdownTableBodyNone"></td></tr>
</table>
<p>``&lsquo;js const anchor = require('markdown-it-anchor&rsquo;) const md = require('markdown-it')()</p>
<p>md.use(anchor, { permalink: anchor.permalink.linkInsideHeader({ symbol: ` <span class="visually-hidden">Jump to heading</span> <span aria-hidden="true">#</span> &lsquo;, placement: 'before&rsquo; }) }) </p><div class="fragment"><div class="line">```html</div>
<div class="line">&lt;h2 id=&quot;title&quot;&gt;</div>
<div class="line">  &lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot;&gt;</div>
<div class="line">    &lt;span class=&quot;visually-hidden&quot;&gt;Jump to heading&lt;/span&gt;</div>
<div class="line">    &lt;span aria-hidden=&quot;true&quot;&gt;#&lt;/span&gt;</div>
<div class="line">  &lt;/a&gt;</div>
<div class="line">  Title</div>
<div class="line">&lt;/h2&gt;</div>
</div><!-- fragment --><p>While this example allows more accessible anchors with the same markup as previous versions of markdown-it-anchor, it's still not ideal. The assistive text for permalinks will be read as part of the heading when listing all the titles of the page, e.g. "jump to heading title 1, jump
to heading title 2" and so on. Also that assistive text is not very useful when listing the links in the page (which will read "jump to
heading, jump to heading, jump to heading" for each of your permalinks).</p>
<h2><a class="anchor" id="autotoc_md739"></a>
ARIA hidden</h2>
<p>This is just an alias for <a href="#link-inside-header"><code>linkInsideHeader</code></a> with <code>ariaHidden: true</code> by default, to mimic GitHub's way of rendering permalinks.</p>
<p>Setting <code>aria-hidden="true"</code> makes the permalink explicitly inaccessible instead of having the permalink and its symbol being read by screen readers as part of every single headings (which was a pretty terrible experience).</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> anchor = require(<span class="stringliteral">&#39;markdown-it-anchor&#39;</span>)</div>
<div class="line">const md = require(&#39;markdown-it&#39;)()</div>
<div class="line"> </div>
<div class="line">md.use(anchor, {</div>
<div class="line">  permalink: anchor.permalink.ariaHidden({</div>
<div class="line">    placement: <span class="stringliteral">&#39;before&#39;</span></div>
<div class="line">  })</div>
<div class="line">})</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;h2 id=&quot;title&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#title&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Title&lt;/h2&gt;</div>
</div><!-- fragment --><p>While no experience might be arguably better than a bad experience, I would instead recommend using one of the above renderers to provide an accessible experience. My favorite one is the <a href="#header-link">header link</a>, which is also the simplest one.</p>
<h2><a class="anchor" id="autotoc_md740"></a>
Custom permalink</h2>
<p>If none of those options suit you, you can always make your own renderer! Take inspiration from <a href="permalink.js">the code behind all permalinks</a>.</p>
<p>The signature of the function you pass in the <code>permalink</code> option is the following:</p>
<div class="fragment"><div class="line"><span class="keyword">function</span> renderPermalink (slug, opts, state, idx) {}</div>
</div><!-- fragment --><p>Where <code>opts</code> are the markdown-it-anchor options, <code>state</code> is a markdown-it <a href="https://github.com/markdown-it/markdown-it"><code>StateCore</code></a> instance, and <code>idx</code> is the index of the <code>heading_open</code> token in the <code>state.tokens</code> array. That array contains <a href="https://markdown-it.github.io/markdown-it/#Token"><code>Token</code></a> objects.</p>
<p>To make sense of the "token stream" and the way token objects are organized, you will probably want to read the <a href="https://github.com/markdown-it/markdown-it/blob/master/docs/architecture.md">markdown-it design principles</a> page.</p>
<p>This function can freely modify the token stream (<code>state.tokens</code>), usually around the given <code>idx</code>, to construct the anchor.</p>
<p>Because of the way the token stream works, a <code>heading_open</code> token is usually followed by a <code>inline</code> token that contains the actual text (and inline markup) of the heading, and finally a <code>heading_close</code> token. This is why you'll see most built-in permalink renderers touch <code>state.tokens[idx + 1]</code>, because they update the contents of the <code>inline</code> token that follows a <code>heading_open</code>.</p>
<h1><a class="anchor" id="autotoc_md741"></a>
Debugging</h1>
<p>If you want to debug this library more easily, we support source maps.</p>
<p>Use the <a href="https://www.npmjs.com/package/source-map-support">source-map-support</a> module to enable it with Node.js.</p>
<div class="fragment"><div class="line">node -r source-map-support/register your-script.js</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md742"></a>
Development</h1>
<div class="fragment"><div class="line"># Build the library in the `dist/` directory.</div>
<div class="line">npm run build</div>
<div class="line"> </div>
<div class="line"># Watch file changes to update `dist/`.</div>
<div class="line">npm run dev</div>
<div class="line"> </div>
<div class="line"># Run tests, will use the build version so make sure to build after</div>
<div class="line"># making changes.</div>
<div class="line">npm test</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
